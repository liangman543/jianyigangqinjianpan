<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€æ˜“é’¢ç´é”®ç›˜</title>
    <style>
        :root {
            --bg-color: #0f172a;
            --window-bg: #1e293b;
            --header-bg: #334155;
            --header-bg-dragging: #4f46e5;
            --text-color: #f1f5f9;
            --white-key: #ffffff;
            --white-key-active: #cbd5e1;
            --black-key: #000000;
            --black-key-active: #374151;
            --border-color: #475569;
            --accent-color: #6366f1;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* é¡¶éƒ¨å·¥å…·æ  */
        #toolbar {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(8px);
            padding: 8px 20px;
            border-radius: 999px;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            z-index: 10000;
        }

        h1 {
            font-size: 16px;
            font-weight: 600;
            margin-right: 10px;
            color: #e2e8f0;
        }

        .tool-btn {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 6px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tool-btn:hover {
            background: #4f46e5;
            transform: translateY(-1px);
        }

        .tool-btn.secondary {
            background: #475569;
        }

        .tool-btn.secondary:hover {
            background: #334155;
        }

        /* é’¢ç´çª—å£ */
        .piano-window {
            position: absolute;
            background: var(--window-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            width: fit-content;
            /* ä¿è¯æœ€å°å®½åº¦ */
            min-width: 200px; 
            touch-action: none;
        }

        /* çª—å£æ ‡é¢˜æ  */
        .window-header {
            height: 36px;
            background: var(--header-bg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
            cursor: move;
            transition: background 0.2s;
            border-bottom: 1px solid #334155;
        }

        .window-header.dragging {
            background: var(--header-bg-dragging);
        }

        .window-title {
            font-size: 13px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 6px;
            color: #e2e8f0;
        }

        .window-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 4px;
            background: rgba(0,0,0,0.2);
            padding: 2px 4px;
            border-radius: 4px;
        }

        .control-label {
            font-size: 10px;
            color: #94a3b8;
            margin-right: 2px;
        }

        .icon-btn {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            background: #475569;
            color: white;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            line-height: 1;
        }
        
        .icon-btn:hover {
            background: var(--accent-color);
        }

        .close-btn {
            background: transparent;
            color: #94a3b8;
            padding: 2px;
            font-size: 16px;
            line-height: 1;
            border: none;
            cursor: pointer;
            margin-left: 5px;
        }

        .close-btn:hover {
            color: #ef4444;
        }

        /* é”®ç›˜ä¸»ä½“åŒºåŸŸ */
        .keyboard-body {
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: #0f172a;
        }

        /* ä¾§è¾¹å…«åº¦æŒ‰é’® */
        .octave-controls {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        /* ç´é”®å®¹å™¨ */
        .keys-container {
            background: #000;
            padding: 4px 0 0 4px; /* ä¸Šå·¦ç•™ä¸€ç‚¹é»‘è¾¹ */
            border-radius: 2px;
            display: flex;
            position: relative;
            /* å…³é”®ï¼šå…è®¸é»‘é”®æº¢å‡ºæ˜¾ç¤º */
            overflow: visible; 
            /* å…³é”®ï¼šæ¶ˆé™¤ flex é—´éš™ */
            font-size: 0; 
        }
        
        /* å®¹å™¨å³è¾¹æ¡†è¡¥å…¨ */
        .keys-wrapper {
            background: #000;
            padding-right: 4px;
            padding-bottom: 4px;
            border-radius: 4px;
        }

        /* ç™½é”® */
        .white-key {
            background: var(--white-key);
            /* ä½¿ç”¨è¾¹æ¡†æ¨¡æ‹Ÿé”®ç¼ */
            border: 1px solid #94a3b8; 
            border-top: none; /* é¡¶éƒ¨ä¸éœ€è¦è¾¹æ¡† */
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
            cursor: pointer;
            position: relative;
            z-index: 1;
            display: inline-block;
            box-shadow: inset 0 -3px 5px rgba(0,0,0,0.1);
        }

        .white-key.active {
            background: var(--white-key-active);
            box-shadow: inset 0 -2px 5px rgba(0,0,0,0.2);
            transform: translateY(1px); /* ç®€å•çš„æŒ‰å‹æ•ˆæœ */
        }

        /* é”®åæ ‡è®° (ä»…Cé”®æ˜¾ç¤º) */
        .key-label {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 9px;
            color: #94a3b8;
            pointer-events: none;
            font-family: monospace;
        }

        /* é»‘é”® */
        .black-key {
            background: var(--black-key);
            position: absolute;
            top: 0;
            /* æ ¸å¿ƒå¸ƒå±€è¦æ±‚ï¼šé»‘é”®å±…ä¸­äºä¸¤ä¸ªç™½é”®ä¹‹é—´ */
            /* çˆ¶çº§æ˜¯å·¦ä¾§ç™½é”®ï¼Œleft: 100% åˆ°è¾¾å³è¾¹ç¼˜ï¼ŒtranslateX(-50%) å›é€€ä¸€åŠå®½åº¦ */
            left: 100%;
            transform: translateX(-50%);
            z-index: 10;
            border-bottom-left-radius: 3px;
            border-bottom-right-radius: 3px;
            box-shadow: 2px 2px 3px rgba(0,0,0,0.4), inset 1px -5px 5px rgba(255,255,255,0.1);
            cursor: pointer;
            border: 1px solid #111;
        }

        .black-key.active {
            background: var(--black-key-active);
            box-shadow: inset 0 0 4px rgba(0,0,0,0.5);
        }

        /* åº•éƒ¨ä¿¡æ¯ */
        .window-footer {
            background: var(--window-bg);
            padding: 4px;
            text-align: center;
            font-size: 10px;
            color: #64748b;
            border-top: 1px solid #334155;
        }

        #empty-state {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #475569;
            pointer-events: none;
        }

    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react/": "https://aistudiocdn.com/react@^19.2.1/"
  }
}
</script>
</head>
<body>

    <div id="toolbar">
        <h1>ç®€æ˜“é’¢ç´é”®ç›˜</h1>
        <div style="width: 1px; height: 16px; background: #475569;"></div>
        <button class="tool-btn" onclick="app.createPiano()">+ æ–°å»ºé”®ç›˜</button>
        <button class="tool-btn secondary" onclick="app.resetDesktop()">é‡ç½®æ¡Œé¢</button>
        <span id="count-label" style="font-size: 12px; color: #94a3b8; margin-left: 5px; min-width: 50px;"></span>
    </div>

    <div id="empty-state" style="display: none;">
        <div style="font-size: 40px; margin-bottom: 10px; opacity: 0.5;">ğŸ¹</div>
        <p style="font-size: 16px;">ç‚¹å‡»ä¸Šæ–¹â€œæ–°å»ºé”®ç›˜â€å¼€å§‹</p>
    </div>

    <!-- é’¢ç´çª—å£åŠ¨æ€å®¹å™¨ -->
    <div id="desktop-container"></div>

    <script>
        /**
         * 1. éŸ³é¢‘å¼•æ“ (AudioEngine)
         * ä½¿ç”¨ Web Audio API å®ç°æ— å»¶è¿Ÿã€æ— æ··å“çš„å£°éŸ³åˆæˆã€‚
         */
        class AudioEngine {
            constructor() {
                this.ctx = null;
                this.masterGain = null;
                this.activeOscillators = new Map(); // ç”¨äºè¿½è¸ªæŒ‰ä¸‹çš„é”®ï¼Œå®ç°é•¿æŒ‰å»¶éŸ³
            }

            // æ‡’åŠ è½½åˆå§‹åŒ–ï¼Œå¿…é¡»ç”±ç”¨æˆ·äº¤äº’è§¦å‘
            init() {
                if (!this.ctx) {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    this.ctx = new AudioContext();
                    this.masterGain = this.ctx.createGain();
                    this.masterGain.gain.value = 0.25; // é¿å…å¤šé”®åŒæŒ‰æ—¶çˆ†éŸ³
                    this.masterGain.connect(this.ctx.destination);
                }
                if (this.ctx.state === 'suspended') {
                    this.ctx.resume();
                }
            }

            // è®¡ç®—é¢‘ç‡
            getFrequency(noteName, octave) {
                const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
                const noteIndex = notes.indexOf(noteName);
                // MIDI Note Calculation: (Octave + 1) * 12 + NoteIndex
                const midiNumber = (octave + 1) * 12 + noteIndex;
                return 440 * Math.pow(2, (midiNumber - 69) / 12);
            }

            // æŒ‰ä¸‹ï¼šå¼€å§‹å‘å£°
            startNote(id, noteName, octave) {
                this.init();
                const keyId = `${id}-${noteName}-${octave}`;

                // å¦‚æœå·²ç»åœ¨å“ï¼Œå…ˆåœæ‰æ—§çš„ï¼ˆé¿å…ç›¸ä½æŠµæ¶ˆæˆ–é‡éŸ³ï¼‰
                if (this.activeOscillators.has(keyId)) {
                    this.stopNote(id, noteName, octave);
                }

                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();

                osc.type = 'triangle'; // ä¸‰è§’æ³¢éŸ³è‰²æ¯”è¾ƒæ¥è¿‘ç®€å•çš„ç”µå­ç´
                osc.frequency.setValueAtTime(this.getFrequency(noteName, octave), this.ctx.currentTime);

                // åŒ…ç»œï¼šç¬é—´èµ·éŸ³ (Attack)
                const now = this.ctx.currentTime;
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(1, now + 0.01); 

                osc.connect(gain);
                gain.connect(this.masterGain);
                osc.start();

                this.activeOscillators.set(keyId, { osc, gain });
            }

            // æ¾å¼€ï¼šåœæ­¢å‘å£°
            stopNote(id, noteName, octave) {
                if (!this.ctx) return;
                const keyId = `${id}-${noteName}-${octave}`;
                const noteObj = this.activeOscillators.get(keyId);

                if (noteObj) {
                    const { osc, gain } = noteObj;
                    const now = this.ctx.currentTime;
                    
                    // åŒ…ç»œï¼šå¿«é€Ÿé‡Šæ”¾ (Release)ï¼Œæ— æ··å“
                    gain.gain.cancelScheduledValues(now);
                    gain.gain.setValueAtTime(gain.gain.value, now);
                    gain.gain.linearRampToValueAtTime(0, now + 0.05); // 50ms æ¶ˆå¤±ï¼Œé¿å…â€œå•µâ€å£°

                    osc.stop(now + 0.06);
                    
                    // æ¸…ç†åƒåœ¾
                    setTimeout(() => {
                        osc.disconnect();
                        gain.disconnect();
                    }, 100);
                    
                    this.activeOscillators.delete(keyId);
                }
            }
        }

        const audio = new AudioEngine();

        /**
         * 2. é’¢ç´çª—å£ç±» (PianoWindow)
         * ç®¡ç†å•ä¸ªé’¢ç´çª—å£çš„ DOMã€çŠ¶æ€å’Œäº¤äº’ã€‚
         */
        class PianoWindow {
            constructor(id, name, x, y, zIndex) {
                this.id = id;
                this.name = name;
                this.x = x;
                this.y = y;
                this.zIndex = zIndex;
                
                // çŠ¶æ€
                this.startOctave = 3;
                this.endOctave = 4;
                this.scale = 36; // ç™½é”®å®½åº¦ (px)
                
                // DOM å¼•ç”¨
                this.element = null;
                
                this.render();
            }

            render() {
                // åˆ›å»ºå®¹å™¨
                this.element = document.createElement('div');
                this.element.className = 'piano-window';
                this.element.id = this.id;
                this.updateStyle(); // è®¾ç½®åˆå§‹ä½ç½®å’Œå±‚çº§

                // å¡«å…… HTML ç»“æ„
                this.element.innerHTML = `
                    <div class="window-header">
                        <div class="window-title">ğŸ¹ ${this.name}</div>
                        <div class="window-controls">
                            <!-- ç¼©æ”¾æ§åˆ¶ï¼šæ”¹ä¸ºæŒ‰é’® -->
                            <div class="control-group" onmousedown="event.stopPropagation()">
                                <span class="control-label">å¤§å°</span>
                                <button class="icon-btn scale-decrease" title="ç¼©å°">-</button>
                                <button class="icon-btn scale-increase" title="æ”¾å¤§">+</button>
                            </div>
                            <button class="close-btn" title="å…³é—­">âœ•</button>
                        </div>
                    </div>
                    <div class="keyboard-body">
                        <div class="octave-controls">
                            <button class="icon-btn add-low" title="æ·»åŠ ä½å…«åº¦">+</button>
                            <button class="icon-btn remove-low" title="ç§»é™¤ä½å…«åº¦">-</button>
                        </div>
                        
                        <div class="keys-wrapper">
                            <div class="keys-container">
                                <!-- é”®ä½å°†é€šè¿‡ JS æ’å…¥ -->
                            </div>
                        </div>

                        <div class="octave-controls">
                            <button class="icon-btn add-high" title="æ·»åŠ é«˜å…«åº¦">+</button>
                            <button class="icon-btn remove-high" title="ç§»é™¤é«˜å…«åº¦">-</button>
                        </div>
                    </div>
                    <div class="window-footer">
                        éŸ³åŸŸèŒƒå›´: <span class="range-display">C${this.startOctave} - B${this.endOctave}</span>
                    </div>
                `;

                // ç»‘å®šæ‰€æœ‰äº‹ä»¶
                this.bindEvents();
                
                // åˆæ¬¡æ¸²æŸ“ç´é”®
                this.renderKeys();

                // æŒ‚è½½åˆ°é¡µé¢
                document.getElementById('desktop-container').appendChild(this.element);
            }

            updateStyle() {
                if (this.element) {
                    this.element.style.left = this.x + 'px';
                    this.element.style.top = this.y + 'px';
                    this.element.style.zIndex = this.zIndex;
                }
            }

            bindEvents() {
                const el = this.element;

                // 1. å…³é—­æŒ‰é’®
                el.querySelector('.close-btn').onclick = (e) => {
                    e.stopPropagation();
                    app.removePiano(this.id);
                };

                // 2. ç¼©æ”¾æŒ‰é’®
                el.querySelector('.scale-decrease').onclick = () => this.changeScale(-4);
                el.querySelector('.scale-increase').onclick = () => this.changeScale(4);

                // 3. å…«åº¦æŒ‰é’®
                el.querySelector('.add-low').onclick = () => this.changeOctave(-1, 'start');
                el.querySelector('.remove-low').onclick = () => this.changeOctave(1, 'start');
                el.querySelector('.add-high').onclick = () => this.changeOctave(1, 'end');
                el.querySelector('.remove-high').onclick = () => this.changeOctave(-1, 'end');

                // 4. ç‚¹å‡»çª—å£ç½®é¡¶
                el.onmousedown = () => app.bringToFront(this.id);

                // 5. æ‹–æ‹½é€»è¾‘
                const header = el.querySelector('.window-header');
                header.onmousedown = (e) => {
                    // å¦‚æœç‚¹åœ¨æŒ‰é’®ä¸Šï¼Œä¸è§¦å‘æ‹–æ‹½
                    if (e.target.tagName === 'BUTTON') return;
                    
                    e.preventDefault();
                    app.bringToFront(this.id);
                    
                    const startX = e.clientX;
                    const startY = e.clientY;
                    const initialLeft = this.x;
                    const initialTop = this.y;
                    
                    header.classList.add('dragging');

                    const onMove = (moveEvent) => {
                        const dx = moveEvent.clientX - startX;
                        const dy = moveEvent.clientY - startY;
                        this.x = initialLeft + dx;
                        this.y = initialTop + dy;
                        this.updateStyle();
                    };

                    const onUp = () => {
                        header.classList.remove('dragging');
                        document.removeEventListener('mousemove', onMove);
                        document.removeEventListener('mouseup', onUp);
                    };

                    document.addEventListener('mousemove', onMove);
                    document.addEventListener('mouseup', onUp);
                };
            }

            changeScale(delta) {
                let newScale = this.scale + delta;
                if (newScale < 20) newScale = 20; // æœ€å°å®½åº¦
                if (newScale > 80) newScale = 80; // æœ€å¤§å®½åº¦
                this.scale = newScale;
                this.renderKeys();
            }

            changeOctave(delta, type) {
                if (type === 'start') {
                    const newVal = this.startOctave + delta;
                    if (newVal < 0 || newVal >= this.endOctave) return;
                    this.startOctave = newVal;
                } else {
                    const newVal = this.endOctave + delta;
                    if (newVal > 8 || newVal <= this.startOctave) return;
                    this.endOctave = newVal;
                }
                this.element.querySelector('.range-display').textContent = `C${this.startOctave} - B${this.endOctave}`;
                this.renderKeys();
            }

            // æ ¸å¿ƒåŠŸèƒ½ï¼šæ¸²æŸ“ç´é”® HTML
            renderKeys() {
                const container = this.element.querySelector('.keys-container');
                container.innerHTML = '';

                // å°ºå¯¸è®¡ç®—
                const wKeyW = this.scale;
                const wKeyH = this.scale * 4.5;
                const bKeyW = wKeyW * 0.6; // é»‘é”®å®½åº¦æ˜¯ç™½é”®çš„ 60%
                const bKeyH = wKeyH * 0.65;

                const notes = [
                    { name: 'C', hasSharp: true },
                    { name: 'D', hasSharp: true },
                    { name: 'E', hasSharp: false },
                    { name: 'F', hasSharp: true },
                    { name: 'G', hasSharp: true },
                    { name: 'A', hasSharp: true },
                    { name: 'B', hasSharp: false },
                ];

                for (let o = this.startOctave; o <= this.endOctave; o++) {
                    notes.forEach(note => {
                        // 1. åˆ›å»ºç™½é”®
                        const whiteKey = document.createElement('div');
                        whiteKey.className = 'white-key';
                        whiteKey.style.width = wKeyW + 'px';
                        whiteKey.style.height = wKeyH + 'px';
                        
                        // C é”®åŠ æ ‡ç­¾
                        if (note.name === 'C') {
                            const label = document.createElement('span');
                            label.className = 'key-label';
                            label.textContent = 'C' + o;
                            whiteKey.appendChild(label);
                        }

                        // ç»‘å®šäº‹ä»¶
                        this.bindKeyInteractions(whiteKey, note.name, o, false);

                        // 2. å¦‚æœæœ‰é»‘é”®ï¼Œå°†å…¶ä½œä¸ºå­å…ƒç´ æ”¾åœ¨ç™½é”®é‡Œ
                        if (note.hasSharp) {
                            const blackKey = document.createElement('div');
                            blackKey.className = 'black-key';
                            blackKey.style.width = bKeyW + 'px';
                            blackKey.style.height = bKeyH + 'px';
                            
                            // å¸ƒå±€å…³é”®ç‚¹ï¼šé»‘é”®æ˜¯å·¦ä¾§ç™½é”®çš„å­å…ƒç´ ï¼Œleft: 100% ä½¿å…¶ä½äºå³è¾¹ç¼˜ï¼Œtranslate -50% ä½¿å…¶ä¸­å¿ƒå¯¹é½å³è¾¹ç¼˜
                            // ä»è€Œæ­£å¥½ä½äºä¸¤ä¸ªç™½é”®ä¸­é—´
                            
                            this.bindKeyInteractions(blackKey, note.name + '#', o, true);
                            whiteKey.appendChild(blackKey);
                        }

                        container.appendChild(whiteKey);
                    });
                }
            }

            // ç»Ÿä¸€å¤„ç†é¼ æ ‡å’Œè§¦æ‘¸äº‹ä»¶
            bindKeyInteractions(dom, noteName, octave, isBlack) {
                const start = (e) => {
                    // é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼ˆé˜²æ­¢ç§»åŠ¨ç«¯æ»šåŠ¨ï¼Œé˜²æ­¢é»‘é”®ç‚¹å‡»ç©¿é€ï¼‰
                    e.preventDefault(); 
                    e.stopPropagation();

                    if (!dom.classList.contains('active')) {
                        dom.classList.add('active');
                        audio.startNote(this.id, noteName, octave);
                    }
                };

                const stop = (e) => {
                    e.preventDefault();
                    if (dom.classList.contains('active')) {
                        dom.classList.remove('active');
                        audio.stopNote(this.id, noteName, octave);
                    }
                };

                // é¼ æ ‡
                dom.addEventListener('mousedown', start);
                dom.addEventListener('mouseup', stop);
                dom.addEventListener('mouseleave', stop);

                // è§¦æ‘¸
                dom.addEventListener('touchstart', start, { passive: false });
                dom.addEventListener('touchend', stop);
                dom.addEventListener('touchcancel', stop);
            }
        }

        /**
         * 3. åº”ç”¨ç®¡ç†å™¨ (App)
         * å…¨å±€çŠ¶æ€ç®¡ç†
         */
        class App {
            constructor() {
                this.pianos = new Map();
                this.nextId = 1;
                this.maxZIndex = 100;
                this.labelEl = document.getElementById('count-label');
                this.emptyEl = document.getElementById('empty-state');
            }

            init() {
                this.createPiano();
            }

            createPiano() {
                const id = 'piano-' + Date.now() + Math.random();
                const name = `é’¢ç´${this.nextId++}`;
                
                // ç®€å•çš„ç€‘å¸ƒæµä½ç½®è®¡ç®—
                const offset = (this.pianos.size % 10) * 30;
                const x = 50 + offset;
                const y = 80 + offset;

                const piano = new PianoWindow(id, name, x, y, ++this.maxZIndex);
                this.pianos.set(id, piano);
                this.updateUI();
            }

            removePiano(id) {
                const piano = this.pianos.get(id);
                if (piano) {
                    piano.element.remove(); // DOM ç§»é™¤
                    this.pianos.delete(id); // å†…å­˜ç§»é™¤
                    this.updateUI();
                }
            }

            resetDesktop() {
                // æ¸…ç©ºå½“å‰
                this.pianos.forEach(p => p.element.remove());
                this.pianos.clear();
                
                // é‡ç½®è®¡æ•°
                this.nextId = 1;
                this.maxZIndex = 100;

                // æ–°å»ºä¸€ä¸ª
                this.createPiano();
            }

            bringToFront(id) {
                const piano = this.pianos.get(id);
                if (piano && piano.zIndex !== this.maxZIndex) {
                    piano.zIndex = ++this.maxZIndex;
                    piano.element.style.zIndex = piano.zIndex;
                }
            }

            updateUI() {
                const count = this.pianos.size;
                this.labelEl.textContent = `${count} ä¸ªçª—å£`;
                this.emptyEl.style.display = count === 0 ? 'block' : 'none';
            }
        }

        const app = new App();
        app.init();

    </script>
</body>
</html>